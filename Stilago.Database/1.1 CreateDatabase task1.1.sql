select cast(serverproperty('EngineEdition') as int)
go
IF db_id(N'Stilago') IS NOT NULL SELECT 1 ELSE SELECT Count(*) FROM sys.databases WHERE [name]=N'Stilago'
go
create database [Stilago]
go
USE [Stilago]
go
if serverproperty('EngineEdition') <> 5 execute sp_executesql N'alter database [Stilago] set read_committed_snapshot on'
go
IF db_id(N'Stilago') IS NOT NULL SELECT 1 ELSE SELECT Count(*) FROM sys.databases WHERE [name]=N'Stilago'

go
CREATE TABLE [dbo].[Brand] (
    [Id] [uniqueidentifier] NOT NULL,
    [Name] [nvarchar](max),
    [CountryId] [uniqueidentifier] NOT NULL,
    [IsDeleted] [bit] NOT NULL,
    [CreationTime] [datetimeoffset](7) NOT NULL,
    [LastModificationTime] [datetimeoffset](7) NOT NULL,
    [CreatedById] [uniqueidentifier] NOT NULL,
    [ModifiedById] [uniqueidentifier] NOT NULL,
    CONSTRAINT [PK_dbo.Brand] PRIMARY KEY ([Id])
)
go
CREATE INDEX [IX_CountryId] ON [dbo].[Brand]([CountryId])
go
CREATE TABLE [dbo].[BrandComputerRelationships] (
    [Id] [uniqueidentifier] NOT NULL,
    [ComputerId] [uniqueidentifier] NOT NULL,
    [BrandId] [uniqueidentifier] NOT NULL,
    CONSTRAINT [PK_dbo.BrandComputerRelationships] PRIMARY KEY ([Id])
)
go
CREATE INDEX [IX_ComputerId] ON [dbo].[BrandComputerRelationships]([ComputerId])
go
CREATE INDEX [IX_BrandId] ON [dbo].[BrandComputerRelationships]([BrandId])
go
CREATE TABLE [dbo].[Computer] (
    [Id] [uniqueidentifier] NOT NULL,
    [Model] [nvarchar](15) NOT NULL,
    [DiskCapacity] [bigint] NOT NULL,
    [IsDeleted] [bit] NOT NULL,
    [CreationTime] [datetimeoffset](7) NOT NULL,
    [LastModificationTime] [datetimeoffset](7) NOT NULL,
    [CreatedById] [uniqueidentifier] NOT NULL,
    [ModifiedById] [uniqueidentifier] NOT NULL,
    CONSTRAINT [PK_dbo.Computer] PRIMARY KEY ([Id])
)
go
CREATE TABLE [dbo].[ComputerInfo] (
    [Id] [uniqueidentifier] NOT NULL,
    [Price] [bigint] NOT NULL,
    [Description] [nvarchar](max),
    [CountryId] [uniqueidentifier] NOT NULL,
    [ComputerId] [uniqueidentifier] NOT NULL,
    [IsDeleted] [bit] NOT NULL,
    [CreationTime] [datetimeoffset](7) NOT NULL,
    [LastModificationTime] [datetimeoffset](7) NOT NULL,
    [CreatedById] [uniqueidentifier] NOT NULL,
    [ModifiedById] [uniqueidentifier] NOT NULL,
    CONSTRAINT [PK_dbo.ComputerInfo] PRIMARY KEY ([Id])
)
go
CREATE INDEX [IX_CountryId] ON [dbo].[ComputerInfo]([CountryId])
go
CREATE INDEX [IX_ComputerId] ON [dbo].[ComputerInfo]([ComputerId])
go
CREATE TABLE [dbo].[Country] (
    [Id] [uniqueidentifier] NOT NULL,
    [Name] [nvarchar](max) NOT NULL,
    [Culture] [nvarchar](max) NOT NULL,
    CONSTRAINT [PK_dbo.Country] PRIMARY KEY ([Id])
)
go
CREATE TABLE [dbo].[User] (
    [Id] [uniqueidentifier] NOT NULL,
    [FirstName] [nvarchar](max) NOT NULL,
    [LastName] [nvarchar](max) NOT NULL,
    [CountryId] [uniqueidentifier] NOT NULL,
    CONSTRAINT [PK_dbo.User] PRIMARY KEY ([Id])
)
go
CREATE INDEX [IX_CountryId] ON [dbo].[User]([CountryId])
go
ALTER TABLE [dbo].[Brand] ADD CONSTRAINT [FK_dbo.Brand_dbo.Country_CountryId] FOREIGN KEY ([CountryId]) REFERENCES [dbo].[Country] ([Id]) ON DELETE CASCADE
go
ALTER TABLE [dbo].[BrandComputerRelationships] ADD CONSTRAINT [FK_dbo.BrandComputerRelationships_dbo.Brand_BrandId] FOREIGN KEY ([BrandId]) REFERENCES [dbo].[Brand] ([Id]) ON DELETE CASCADE
go
ALTER TABLE [dbo].[BrandComputerRelationships] ADD CONSTRAINT [FK_dbo.BrandComputerRelationships_dbo.Computer_ComputerId] FOREIGN KEY ([ComputerId]) REFERENCES [dbo].[Computer] ([Id]) ON DELETE CASCADE
go
ALTER TABLE [dbo].[ComputerInfo] ADD CONSTRAINT [FK_dbo.ComputerInfo_dbo.Computer_ComputerId] FOREIGN KEY ([ComputerId]) REFERENCES [dbo].[Computer] ([Id]) ON DELETE CASCADE
go
ALTER TABLE [dbo].[ComputerInfo] ADD CONSTRAINT [FK_dbo.ComputerInfo_dbo.Country_CountryId] FOREIGN KEY ([CountryId]) REFERENCES [dbo].[Country] ([Id]) ON DELETE CASCADE
go
ALTER TABLE [dbo].[User] ADD CONSTRAINT [FK_dbo.User_dbo.Country_CountryId] FOREIGN KEY ([CountryId]) REFERENCES [dbo].[Country] ([Id]) ON DELETE CASCADE
go
CREATE TABLE [dbo].[__MigrationHistory] (
    [MigrationId] [nvarchar](150) NOT NULL,
    [ContextKey] [nvarchar](300) NOT NULL,
    [Model] [varbinary](max) NOT NULL,
    [ProductVersion] [nvarchar](32) NOT NULL,
    CONSTRAINT [PK_dbo.__MigrationHistory] PRIMARY KEY ([MigrationId], [ContextKey])
)
go
INSERT [dbo].[__MigrationHistory]([MigrationId], [ContextKey], [Model], [ProductVersion])
VALUES (N'201501230013022_initialSetup', N'Stilago',  0x1F8B0800000000000400ED5D5B6FE336167E5F60FF83A0A7DD451A25D3DD6E1BD82D32CEA40876663218678A7D0B68897688912857A2B2318AFEB27DD89FD4BFB0A4EEBC482265D99693A04011F37278CEE1391F0F2F47F3C77FFF37F9E929F0AD4718C528C453FBFCF4CCB62076430FE1D5D44EC8F29BEFED9F7EFCF39F26EFBCE0C9FAA568F72D6B477BE2786A3F10B2BE709CD87D8001884F03E446611C2EC9A91B060EF042E7CDD9D90FCEF9B90329099BD2B2ACC9E7041314C0F407FD390BB10BD72401FE87D0837E9C97D39A794AD5FA080218AF810BA7F69C201FACC2D3779402D95C47B4E63F61F4D5B62E7D04283B73E82F6D0B601C124028B3175F623827518857F3352D00FEDD660D69BB25F063980B715135D795E7EC0D93C7A93A16A4DC2426616048F0FCDB5C418ED8BD979AED5281548599A298D4A91AA7F6DB0860CFB6C4912E667EC45A552ACE26E3346D7F6215A5B3308227A529508B61FF9D58B3C4274904A718262402FE89F52959F8C8FD17DCDC855F219EE2C4F7EB7C51CE681D57408B3E45E11A4664F3192E736E6F28AB0EDFCF113B96DD6A7D32517E4E10FDFB231D1B2C7C58CEBAD3DA9DFDBF20404D87BA826D7D004FEF215E9187A94DFFB4AD6BF404BDA224A7FA0523EA39B4138992CE416621F58168B325AB37F115F421812595B761E843808D09CD22985AC11DAA64BF0204B2DFB7CB650C8931C9F72026D484D012B943934EB985DEDB6DD597B1D787D047F08856A958D2BC06EB84C0E833F4D3EAF801AD63DBAAFFCC402AF32B55F3FBDC43AFA330F81CFA85CB3637BDBF03D18AA9F12ED46B3F0F93C835122A35D66631EECB1602D345453924C762595B08506768E254D0D50D682A694D414E45E325015F21FF9664525D0EE650B933ECD68194D6A9E170A6A8A094A3A82CBC211D42C08F4A94EED6121C6874512182B60356D269FB5BD1E525B9572A7A4B6071FE0FADB8C270D42B147F9D011A3CD3392B06BFC1E4BBBFBF061BCF26D8B8C1CBB0155A5883FBCA4D6534E11A340208DFAA6714A182B77DA0A288F10640BA152A6693638C8CACDB4B42C74F1172E176007505633742EB6CDF7C14FBB78122AE57641E2B320F89CA4D00A6C6EE21F676C208D2164F55DFC5E6001BBE921303504D7BBC243C1DE814CBD4253305EE7A606D53F9121B6D4B58F3976424D7288AC9612C85AD0B07B2D17E4B772F046506A542CE7AB984985CA509525EC671E8A29487AEB3B1FC8C8417F11DF62CC303936CEE5A8F63E89C528F416BEA2394E7A9FD3749B5FAE3963B13615C718C735BF4B75B9CC548D6A59BDDCBCC40EC024F9E67AA5B8F2FA12E0A2388D9EDD18C72439D1E6122FB33C22E5A03DF4C12818C26303036CB01C59A2BB886D8A3FC9ACDA50E27E5D19ECC4E39AAA0CD2EE54D9C9AD5B61BB33A6E6A32A58E20AA32207EA3A66FAB1D7B677980F11969AB087B30CDD639D219BFBE811A834D6640AF693102FA0F6E91FC02C2D1CF17A491DB2327C0FECD919B1F3D6B2C238B831A63CB995997E9E81CA0ED19D98C986C0A10FA05265B1971B72AF768D2DD2A3B0AB8E56F9B5BA3C8368055C68C9D71E95142AA92F37D459DC708A2DC96ADC91ED4FBB7CA1CB273077DFB526EF98EC1BC548CEFC1BA54FA1F9F7165BB74DA87D01E30CA79C88F97AE16AC023E11C5F914152F3FA28AF3430ED17018E1392475588C6DAB3A16E0814EB23B45F786974B6A92EAE5B46398A2938A6A1549681261315A1BA12C76EE24C6CC014135A1DCE53A68305354F5CF2040E85C33140DF5170F596ABD34DFBE88B66D7EB2538AD96E1E9217999FE58823495439FFA2ED3454DA70C5222B52E34CC1E054A1268A60A72D7A6A3F475090DC81827253EFD48F6255D4DFE10EA11D7E85E42896AE3C9872DADE1E34AB4A77F7D577FFA563117DB74DBDBCBE87868557A30D00A76170EA50BF13523482FB1DD9167F23200BDE1C7E7607A03596F355A9456A65C8B9A5D0C5C54419F294751327CBE5C80B264E43D2C7E40358AF115ED59240F2126B9E6580CCBE999B674504190DC7E57C500CD0CA9148188115146A994A3C985E995D010216805D12CDBC406A2605780D0144311C17C3C91356C4154573F63717498AC930A7CA18A0D2246DB80A582CCDE484A2AFC8FD2C9688037C10292E1F67A19F04B839A66FEE9D5DFED5FB6725FA146AC17C9D4C4B8CDF224BF5848613A92A36E08B7B45C3B1C6D5E853543FA2A95356B730E4B9780223B15C54E8D3E3DFD4D409F23532C5892398A9B44F935C42DAD9F20EA6EF7EEAE56E309754EE9A7ABAA91EADDDB86EFD1890F7BCE6E3C1666AE5A5629D54E34DE3C10CA48AB586B087A6AD86C6F43777DDCD6CE7EFD6051F6645FA34F857E875527CCD2B60BF02B6A13F665BC8217D323D3AEAEF97EAEEBBF1CDFCD5749D405E64E09BF567D39C6BD62B0E13960DBBD2BC62C68BC78C624F3B0C5E2877E95A50D1D073B45BADE25D2F673545E168E6373BF518626ED3D37BF3895577DBCDACD61EEFD689D48ACDB047265595EE16FD776A2DD29994D8A41CBD3C9B12CEA026F97950F7D749A403A2AC896D51253D222F3D1CDAC40406A7ACC1E9FC577FE6232A6FD5E003C0680963923D25B7DF9C9DBF11BE6D329EEF8C3871ECF98AF3348D8F8D5C2ED6F7734A365B78A7F69D7CC7B98737F30946BF2610B12B5FB65A455B2559E04710B90F20FA4B009EFE5AA7D42B9D4C664DD2E10DF6E0D3D4FE2D257161DDFCFBBEA47262DD46D4982EAC33EBF7EDB3C916A8676E9690EEE5D118837DF727CCD3BD3E45D045D91785FE39685ED9A00329B2CCB6B61B55C69921D1013E8F717CFE26E74BF6F49382CC568E227CE8A2172B390D033E86F82CC333815FEE8B0A05FE4ADF5418E083090BB442D81C045F91F45921694746FF33712A2E11BFA7E12B32F19F4D7834AE35E815629E19C4A8DE1D1F036C686D85FAE4909B1033CB0B3F3E254BF9DADB695ACCC1DE72DE0E06D27BCA87DE73DAB1C64BDA83E63935BD32DA5F02F3B3CD591E43925D16E5F6CE4ADD2A756EDFC99EC791FC66986B9C3F31DD7316D1580CA9E96A6E0C7674F459C287C4A7712E86FB44AEEDD6C383C3985E0EEFE1F14B33E63B3EC4D20FDC0E0D555AB9B887B7942CD5CF38FD77EC76D2F006E2D066225CE7973C88B919E26C29725E9B3366B38BFBA9ED2D58EC92ED3CB74CA635CBA56D64402F254BE4AA5AA42526AA2AD598BD12733BF372DB4632C8DCDDB4E5EDAAC7D04FEA6DCCE955111E73B6AF9C0FD72F6F572F3DF018B277954994DA69A88D99AC63CECBE5DC857B843826B10F90716B6E0B877790C1D267FBDA8526AE1C2E3FB6AF6075E0AF5E74EE2403567E554883A2DABF8C46E3B118AD2A12ECDF49C3D0E5C2A1B20DF3C3223013382A9A88D75A90008FC64A9711414BE0125AEDC2384E3FC2FA0BF013DAE45DB080DE0DBE4D0835622A320C163EA73E16DDB58D9FA6F9F23C4F6ED36BE1780811289B885D1FDEE2B709F2BD92EF6BC5154103091636FE0C69793697340A2570B529297D0CB126A15C7D65B47B078335F57918DFE23978847D78A3A6F71EAE80BB291E873613E99E085EED932B04561108E29C46D59FFEA436EC054F3FFE1F24D4250C20700000 , N'6.1.2-31219')

go
